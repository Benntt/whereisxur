<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Where Is Xûr — Inventory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background: #0b0c10; color: #e8e8e8; }
    header { padding: 24px; text-align: center; }
    .container { max-width: 1100px; margin: 0 auto; padding: 16px; display: grid; grid-template-columns: 1fr minmax(0, 760px) 1fr; gap: 16px; }
    .center { grid-column: 2; }
    h2 { margin: 24px 0 8px; font-size: 20px; border-bottom: 1px solid #30343a; padding-bottom: 6px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; }
    .card { background: #14171b; border: 1px solid #2a2f36; border-radius: 10px; padding: 10px; display: flex; gap: 10px; align-items: center; }
    .card img { width: 48px; height: 48px; object-fit: cover; border-radius: 6px; border: 1px solid #2a2f36; }
    .meta { display: flex; flex-direction: column; }
    .name { font-weight: 600; }
    .sub { font-size: 12px; opacity: 0.85; }
    .stamp { font-size: 12px; opacity: 0.7; margin-top: 8px; }
  </style>
</head>
<body>
  <header>
    <h1>Where Is Xûr</h1>
    <div id="stamp" class="stamp"></div>
  </header>

  <div class="container">
    <div></div>
    <main class="center" id="main"></main>
    <div></div>
  </div>

  <script>
    async function load() {
      const res = await fetch("./data/xur_inventory_filtered.json", { cache: "no-cache" });
      
      if (!res.ok) {
        document.getElementById("main").textContent = "Inventory not available.";
        return;
      }
      const data = await res.json();
      const main = document.getElementById("main");
      document.getElementById("stamp").textContent = `Updated: ${new Date(data.generatedAt).toLocaleString()}`;

      for (const [category, items] of Object.entries(data.categories)) {
        const h = document.createElement("h2");
        h.textContent = category;
        main.appendChild(h);

        const grid = document.createElement("div");
        grid.className = "grid";

        for (const it of items) {
          const card = document.createElement("div");
          card.className = "card";

          const img = document.createElement("img");
          img.src = it.icon || "";
          img.alt = it.name;

          const meta = document.createElement("div");
          meta.className = "meta";

          const name = document.createElement("div");
          name.className = "name";
          name.textContent = it.name;

          const sub = document.createElement("div");
          sub.className = "sub";
          sub.textContent = [it.tier, it.type].filter(Boolean).join(" • ");

          meta.appendChild(name);
          meta.appendChild(sub);

          card.appendChild(img);
          card.appendChild(meta);
          grid.appendChild(card);
        }

        main.appendChild(grid);
      }
    }
    load();
  </script>
</body>
</html>
